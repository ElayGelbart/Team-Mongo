(()=>{"use strict";function e(e){if("object"!=typeof e)return;!function(){const e=document.querySelector("#phonebook"),t=document.querySelectorAll(".phonebook_entry");for(let n of t)e.removeChild(n)}();const t=document.querySelector("#phonebook");for(let n of e){const e=document.createElement("tr");e.classList.add("phonebook_entry");const{id:o,name:r,number:c}=n;[o,r,c].forEach((t=>{const n=document.createElement("td");n.innerText=t,e.appendChild(n)})),t.appendChild(e)}}function t(e,t){let n;switch(t){case"add":n=document.querySelector("#new_result");break;case"search":n=document.querySelector("#search_result");break;case"delete":n=document.querySelector("#delete_result");break;default:return}n.style.visibility="visible",n.innerText=e,setTimeout((()=>{n.innerText="",n.style.visibility="hidden"}),3e3)}document.body.style.backgroundColor="cornsilk";const n="http://localhost:3001/api/persons";!async function(){try{e((await axios.get(`${n}`)).data)}catch(e){console.log(e.response.data)}}(),document.querySelector("#search_btn").addEventListener("click",(async function(){const e=document.querySelector("#search_id").value;if(e)try{!function(e){const{id:t,name:n,number:o}=e,r=document.querySelector("#search_result");r.style.visibility="visible",r.innerText=`ID: ${t}\n     Name: ${n}\n     Number: ${o}`}((await axios.get(`${n}/${e}`)).data)}catch(e){t(e.response.data.error,"search")}})),document.querySelector("#submit_btn").addEventListener("click",(async function(){const o=function(){const e=document.querySelectorAll(".new_person");for(let n of e)if(!n.value)return t("Please fill every field.","add"),"missing";return{name:e[0].value,number:e[1].value}}();if("missing"===o)return;const{id:r,name:c,number:a}=o;try{const t=await axios.post(n,{id:r,name:c,number:a});if("Name taken"===t.data[0]){const o=t.data[1];return void e((await axios.put(`${n}`,{existingId:o,name:c,number:a})).data)}return void e(t.data)}catch(e){t(e.response.data.error,"add")}})),document.querySelector("#delete_btn").addEventListener("click",(async function(){const o=document.querySelector("#delete_id").value;if(o)try{e((await axios.delete(`${n}/${o}`)).data)}catch(e){t(e.response.data.error,"delete")}}))})();