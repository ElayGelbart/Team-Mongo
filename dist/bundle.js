(()=>{const e="https://egmongodb.herokuapp.com",t=async()=>{const t=await fetch(`${e}/api/persons`),n=await t.json();document.getElementById("phonebookTableBody").innerHTML="";for(let e of n){const t=document.createElement("tr"),n=document.createElement("th"),a=document.createElement("td"),o=document.createElement("td");n.setAttribute("scope","row"),n.innerText=e._id,a.innerText=e.name,o.innerText=e.phoneNumber,t.append(n,a,o),document.getElementById("phonebookTableBody").appendChild(t)}};t(),document.getElementById("getPhonebookBtn").addEventListener("click",t),document.getElementById("sendServerNewPerson").addEventListener("click",(async()=>{const n=document.getElementById("validationCustomName"),a=document.getElementById("validationCustomPhoneNumber"),o=document.getElementById("nameValidationText"),d=document.getElementById("phoneValidationText");if(!validator.isAlpha(n.value.replace(/\s/,""))||!validator.isLength(n.value,{min:3,max:30}))return n.classList.add("is-invalid"),o.innerText="Name Not Valid",void(o.className="invalid-feedback");if(n.classList.remove("is-invalid"),n.classList.add("is-valid"),o.innerText="Good Name",o.className="valid-feedback",!validator.isMobilePhone(a.value))return a.classList.add("is-invalid"),d.innerText="Phone Not Valid",void(d.className="invalid-feedback");a.classList.remove("is-invalid"),a.classList.add("is-valid"),d.innerText="Great Phone",d.className="valid-feedback";try{await fetch(`${e}/api/persons`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.value,number:a.value})}).then((e=>{if(!e.ok)throw new Error("UserNameTaken");return e})),t()}catch(e){n.classList.add("is-invalid"),o.innerText="Name Taken",o.className="invalid-feedback"}})),document.getElementById("sendSearchPersonIdBtn").addEventListener("click",(async()=>{const t=document.getElementById("validationCustomPersonId").value;if(t)try{const n=await fetch(`${e}/api/persons/${t}`,{headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw new Error("NO ID IN DB");return e})),a=await n.json();document.getElementById("tablePersonData").innerHTML=`\n    <thead>\n    <tr>\n      <th scope="col">ID</th>\n      <th scope="col">Name</th>\n      <th scope="col">Phone</th>\n      <th scope="col">Actions</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th scope="row">${a._id}</th>\n      <td>${a.name}</td>\n      <td>${a.phoneNumber}</td>\n      <td><button class="btn btn-danger" onclick="deletePersonID('${a._id}')">Delete Person</button></td>\n    </tr>\n  </tbody>\n  `,document.getElementById("searchValidationText").innerText=""}catch(e){document.getElementById("validationCustomPersonId").classList.add("is-invalid"),document.getElementById("searchValidationText").innerText="Person Not In Phonebook"}}))})();